<Window x:Class="DentalClinicApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DentalClinicApp"
        mc:Ignorable="d"
        Background="#FF2196F3"
        Title="Стоматологическая клиника" 
        ResizeMode="CanResize"
        SizeToContent="Manual"
        Height="700" Width="1400"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Стиль для иконок меню -->
        <SolidColorBrush x:Key="MenuIconBrush" Color="#333333"/>
        <SolidColorBrush x:Key="MenuIconHoverBrush" Color="#FF2196F3"/>
        <SolidColorBrush x:Key="DataGridColumnHeader" Color="#FFE0F7FA"/>
        <!-- Стиль для заголовка таблицы -->
        <Style TargetType="DataGridColumnHeadersPresenter">
            <Setter Property="Background" Value="#FFE0F7FA"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Padding" Value="0"/>
        </Style>

        <!-- Стиль для заголовков столбцов в DataGrid -->
        <Style TargetType="DataGridColumnHeader" >

            <Setter Property="Background" Value="#FFE0F7FA" />
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Foreground" Value="#333333"/>
            <!-- Темно-серый цвет текста -->
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridColumnHeader">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter 
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FFC0E7F0"/>
                                <!-- Затемнение -->
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль для таблицы -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="#FFC0E7F0"/>
            <Setter Property="RowBackground" Value="#FFC0E7F0"/>
            <Setter Property="AlternatingRowBackground" Value="#FFC0E7F0"/>
            <Setter Property="BorderBrush" Value="#FFC0E7F0"/>
            <Setter Property="GridLinesVisibility" Value="All"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#88000000"/>
            <Setter Property="VerticalGridLinesBrush" Value="#88000000"/>
        </Style>

        <!-- Стиль для строчек в DataGrid -->
        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Style.Triggers>
                <!-- Подсветка при наведении -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF81D4FA"/>
                    <!-- Цвет подсветки -->
                </Trigger>
                <!-- Стиль для выделенной строки -->
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#FF4FC3F7"/>
                    <Setter Property="Foreground" Value="#333333"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="#88000000"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Foreground" Value="#333333"/>
            <!-- Цвет текста -->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border 
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    SnapsToDevicePixels="True">
                            <ContentPresenter 
                        VerticalAlignment="Center"
                        Margin="4,0"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <!-- При выделении -->
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#FF4FC3F7"/>
                    <!-- Голубой фон выделения -->
                    <Setter Property="Foreground" Value="#333333"/>
                    <!-- Тёмный текст -->
                    <Setter Property="BorderBrush" Value="#88000000"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF81D4FA"/>
                    <!-- Цвет светлее -->
                </Trigger>

                <Trigger Property="IsKeyboardFocusWithin" Value="True">
                    <Setter Property="BorderBrush" Value="Black"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для TabControl -->
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="#FF2196F3"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <!-- Стиль для TabItem -->
        <Style TargetType="TabItem">
            <Setter Property="Background" Value="#FF4FC3F7"/>
            <Setter Property="BorderBrush" Value="#FF0288D1"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="2,2,2,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" 
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4,4,0,0">
                            <ContentPresenter x:Name="ContentSite"
                                          ContentSource="Header"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#FF0288D1"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF29B6F6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
       
        <!-- Стиль для MenuItem -->
        <Style TargetType="MenuItem">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Padding" Value="10,4"/>
            <Setter Property="MinWidth" Value="80"/>
            <!--<Style.Triggers>
                --><!--<Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FFB2EBF2"/>
                    <Setter Property="Icon">
                        <Setter.Value>
                            <Path Data="{Binding Path=Data, RelativeSource={RelativeSource Self}}"
                          Fill="{StaticResource MenuIconHoverBrush}"
                          Stretch="Uniform"
                          Width="16"
                          Height="16"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>--><!--
            </Style.Triggers>-->
        </Style>
        
        

        <!-- Стиль для кнопок -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                CornerRadius="8"
                                BorderThickness="1"
                                BorderBrush="#555555"
                                Background="#FF2196F3">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="5" ShadowDepth="2" Color="#40000000"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF42A5F5"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="8" ShadowDepth="3" Color="#60000000"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF1976D2"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="3" ShadowDepth="1" Color="#30000000"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Width" Value="120"/>
            <Setter Property="Height" Value="30"/>
        </Style>

        <!-- Стиль для кнопок в ToolBar -->
        <Style x:Key="ToolBarButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="5,2"/>
            <Setter Property="Margin" Value="2,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="Transparent"
                                BorderThickness="0"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#20000000"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#40000000"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Стиль для для контекстного меню -->
        <Style TargetType="ContextMenu">
            <Setter Property="Background" Value="#FFE0F7FA"/>
            <Setter Property="BorderBrush" Value="#FF0288D1"/>
            <Setter Property="Foreground" Value="#333333"/>
        </Style>
    </Window.Resources>


    <Grid>
        <Grid.ContextMenu>
            <ContextMenu x:Name="MainContextMenu">
                <MenuItem Header="Обновить" Click="RefreshClick" InputGestureText="F5">
                    <MenuItem.Icon>
                        <Path Data="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
                      Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem x:Name="AddMenuItem" Header="Добавить" Click="AddClick" InputGestureText="Ctrl+N">
                    <MenuItem.Icon>
                        <Path Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"
                      Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Name="EditMenuItem" Header="Редактировать" Click="EditClick" InputGestureText="Ctrl+E">
                    <MenuItem.Icon>
                        <Path Data="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"
                      Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Name="DeleteMenuItem" Header="Удалить" Click="DeleteClick" InputGestureText="Del">
                    <MenuItem.Icon>
                        <Path Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"
                      Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem x:Name="StatsMenuItem" Header="Статистика" Click="StatisticsButton_Click" InputGestureText="Ctrl+Shift+S" Visibility="Collapsed">
                    <MenuItem.Icon>
                        <Path Data="M9,17H7V10H9V17M13,17H11V7H13V17M17,17H15V13H17V17M19,19H5V5H19V19.1M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3Z"
                      Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Name="ReportsMenuItem" Header="Отчётность" Click="ReportsButton_Click" InputGestureText="Ctrl+Shift+R" Visibility="Collapsed">
                    <MenuItem.Icon>
                        <Path Data="M19,21H5C3.9,21 3,20.1 3,19V5C3,3.9 3.9,3 5,3H9V5H5V19H19V15H21V19C21,20.1 20.1,21 19,21M17,9V7H12V12H14V10.4L18.6,15L20,13.6L15.4,9H17Z"
                      Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem x:Name="ChartsMenuItem" Header="Графики" Click="ChartsButton_Click" InputGestureText="Ctrl+Shift+G" Visibility="Collapsed">
                    <MenuItem.Icon>
                        <Path Data="M3,22V8H7V22H3M10,22V2H14V22H10M17,22V14H21V22H17Z"
                      Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
            </ContextMenu>
        </Grid.ContextMenu>


        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#FFE0F7FA" Offset="0"/>
                <GradientStop Color="#FFB2EBF2" Offset="0.5"/>
                <GradientStop Color="#FFE0F7FA" Offset="1"/>
            </LinearGradientBrush>
        </Grid.Background>
        <Grid.RowDefinitions>
            <RowDefinition Height="25"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Меню -->
        <Menu Grid.Row="0">
            <MenuItem Header="Файл" MinWidth="80" Width="58" Height="26" HorizontalContentAlignment="Center">
                <MenuItem Header="Обновить" Click="RefreshClick" InputGestureText="F5">
                    <MenuItem.Icon>
                        <Path Data="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Выход" Click="CloseWindow" InputGestureText="Alt+F4">
                    <MenuItem.Icon>
                        <Path Data="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>

            <MenuItem Header="Действия" MinWidth="100">
                <MenuItem Header="Добавить" Click="AddClick" InputGestureText="Ctrl+N">
                    <MenuItem.Icon>
                        <Path Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Редактировать" Click="EditClick" InputGestureText="Ctrl+E">
                    <MenuItem.Icon>
                        <Path Data="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Удалить" Click="DeleteClick" InputGestureText="Del">
                    <MenuItem.Icon>
                        <Path Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="База данных" MinWidth="100">
                <ComboBox x:Name="ProviderDB" Width="120" DropDownClosed="ProviderDB_DropDownClosed"/>
            </MenuItem>
            <MenuItem Header="Справочники" MinWidth="100">
                <MenuItem Header="Пациенты" Click="EditPatient">
                </MenuItem>
                <MenuItem Header="Стоматологи" Click="EditDentist">
                </MenuItem>
            </MenuItem>

            <MenuItem Header="О программе" MinWidth="100" Click="AboutClick">
            </MenuItem>
        </Menu>
        <!-- Панель вкладок -->
        <TabControl x:Name="MainTabControl" Grid.Row="1" SelectionChanged="MainTabControl_SelectionChanged">
            <!-- Вкладка пациентов -->
            <TabItem Header="Пациенты" >
                <Viewbox Stretch="Uniform">
                    <Grid Width="1355" Height="550">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="25*"/>
                            <ColumnDefinition Width="674*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Фон -->
                        <Grid.Background>
                            <VisualBrush Stretch="UniformToFill">
                                <VisualBrush.Visual>
                                    <Image Source="/Images/1.png" Opacity="0.40" Stretch="UniformToFill"/>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>
                        <!-- Подложка для таблицы -->
                        <Border Background="#FFE0F7FA" CornerRadius="5" Margin="10,10,10,452" Grid.ColumnSpan="3">
                            <DataGrid x:Name="DataGridPatients" 
                              CanUserAddRows="True"        
                              ContextMenuOpening="DataGridPatients_ContextMenuOpening"         
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch"         
                              ColumnHeaderStyle="{StaticResource {x:Type DataGridColumnHeader}}"          
                              AutoGenerateColumns="False"
                              SelectionMode="Single"
                              IsReadOnly="False"
                              Background="Transparent"
                              GridLinesVisibility="All"
                              RowBackground="Transparent"
                              AlternatingRowBackground="Transparent"
                              HorizontalGridLinesBrush="#55000000" 
                              VerticalGridLinesBrush="#55000000"                   
                              HeadersVisibility="All"
                              BorderThickness="0">
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Добавить пациента" 
                          Click="AddPatient_Click"
                          InputGestureText="Ctrl+N">
                                            <MenuItem.Icon>
                                                <Path Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Редактировать пациента" 
                          Click="EditPatient_Click"
                          InputGestureText="Ctrl+E"
                          x:Name="EditPatientMenu">
                                            <MenuItem.Icon>
                                                <Path Data="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Удалить пациента" 
                          Click="DeletePatient_Click"
                          InputGestureText="Del"
                          x:Name="DeletePatientMenu">
                                            <MenuItem.Icon>
                                                <Path Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <Separator/>
                                        <MenuItem Header="Статистика пациента" 
                          Click="ShowPatientStats_Click">
                                            <MenuItem.Icon>
                                                <Path Data="M9,17H7V10H9V17M13,17H11V7H13V17M17,17H15V13H17V17M19,19H5V5H19V19.1M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3Z"
                              Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                            </DataGrid>
                        </Border>
                    </Grid>
                </Viewbox>
            </TabItem>

            <!-- Вкладка стоматологов -->
            <TabItem Header="Стоматологи">
                <Viewbox Stretch="Uniform">
                    <Grid Width="1355" Height="560">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="25*"/>
                            <ColumnDefinition Width="674*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Фоновое изображение -->
                        <Grid.Background>
                            <VisualBrush Stretch="UniformToFill">
                                <VisualBrush.Visual>
                                    <Image Source="/Images/2.png" Opacity="0.40" Stretch="UniformToFill"/>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>

                        <!-- Подложка для таблицы -->
                        <Border Background="#FFE0F7FA" CornerRadius="5" Margin="10,10,10,460" Grid.ColumnSpan="2"
                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <DataGrid x:Name="DataGridDentists" 
                              CanUserAddRows="True"        
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch"
                              ColumnHeaderStyle="{StaticResource {x:Type DataGridColumnHeader}}"          
                              AutoGenerateColumns="False"
                              SelectionMode="Single"
                              IsReadOnly="False"
                              Background="Transparent"
                              GridLinesVisibility="All"
                              RowBackground="Transparent"
                              AlternatingRowBackground="Transparent"
                              HorizontalGridLinesBrush="#55000000" 
                              VerticalGridLinesBrush="#55000000"
                              HeadersVisibility="All"
                              BorderThickness="0"/>
                        </Border>
                    </Grid>
                </Viewbox>
            </TabItem>

            <!-- Вкладка записей на прием -->
            <TabItem Header="Записи на прием">
                <Viewbox Stretch="Uniform">
                    <Grid Width="1355" Height="570">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="25*"/>
                            <ColumnDefinition Width="674*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Фоновое изображение -->
                        <Grid.Background>
                            <VisualBrush Stretch="UniformToFill">
                                <VisualBrush.Visual>
                                    <Image Source="/Images/3.png" Opacity="0.40" Stretch="UniformToFill"/>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>

                        <!-- Подложка для таблицы -->
                        <Border Background="#FFE0F7FA" 
                            CornerRadius="5" 
                            Margin="10,10,10,460" 
                            Grid.ColumnSpan="2"
                            HorizontalAlignment="Stretch" 
                            VerticalAlignment="Stretch">

                            <DataGrid x:Name="DataGridAppointments" 
                          CanUserAddRows="True"            
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          ColumnHeaderStyle="{StaticResource {x:Type DataGridColumnHeader}}"          
                          AutoGenerateColumns="False"
                          SelectionMode="Single"
                          IsReadOnly="False"
                          Background="Transparent"
                          GridLinesVisibility="All"
                          RowBackground="Transparent"
                          AlternatingRowBackground="Transparent"
                          HorizontalGridLinesBrush="#55000000" 
                          VerticalGridLinesBrush="#55000000"
                          HeadersVisibility="All"
                          BorderThickness="0"/>
                        </Border>
                    </Grid>
                </Viewbox>
            </TabItem>

            <!-- Вкладка услуг -->
            <TabItem Header="Услуги">
                <Viewbox Stretch="Uniform">
                    <Grid Width="1355" Height="590">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="25*"/>
                            <ColumnDefinition Width="674*"/>
                        </Grid.ColumnDefinitions>
                        <!-- Фоновое изображение -->
                        <Grid.Background>
                            <VisualBrush Stretch="UniformToFill">
                                <VisualBrush.Visual>
                                    <Image Source="/Images/4.png" Opacity="0.40" Stretch="UniformToFill"
                               RenderOptions.BitmapScalingMode="HighQuality"/>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>
                        <!-- Подложка для таблицы -->
                        <Border Background="#FFE0F7FA" 
                            CornerRadius="5" 
                            Margin="10,10,10,460" 
                            Grid.ColumnSpan="2"
                            HorizontalAlignment="Stretch" 
                            VerticalAlignment="Stretch">

                            <DataGrid x:Name="DataGridServices" 
                          CanUserAddRows="True"            
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          ColumnHeaderStyle="{StaticResource {x:Type DataGridColumnHeader}}"          
                          AutoGenerateColumns="False"
                          SelectionMode="Single"
                          IsReadOnly="False"
                          Background="Transparent"
                          GridLinesVisibility="All"
                          RowBackground="Transparent"
                          AlternatingRowBackground="Transparent"
                          HorizontalGridLinesBrush="#55000000" 
                          VerticalGridLinesBrush="#55000000"
                          HeadersVisibility="All"
                          BorderThickness="0"/>
                        </Border>
                    </Grid>
                </Viewbox>
            </TabItem>
            <!-- Вкладка Оказанные услуги -->
            <TabItem Header="Оказанные услуги">
                <Viewbox Stretch="Uniform">
                    <Grid Width="1355" Height="560">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="48*"/>
                            <ColumnDefinition Width="353*"/>
                            <ColumnDefinition Width="953*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Фоновое изображение -->
                        <Grid.Background>
                            <VisualBrush Stretch="UniformToFill">
                                <VisualBrush.Visual>
                                    <Image Source="/Images/5.png" 
                               Opacity="0.40" 
                               Stretch="UniformToFill"
                               RenderOptions.BitmapScalingMode="HighQuality"/>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>

                        <!-- Подложка для таблицы -->
                        <Border Background="#FFE0F7FA" 
                            CornerRadius="5" 
                            Margin="10,10,10,450" 
                            Grid.ColumnSpan="3">
                            <DataGrid x:Name="DataGridServiceRecords" 
                          CanUserAddRows="True"            
                          ContextMenuOpening="DataGridServiceRecords_ContextMenuOpening"            
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          ColumnHeaderStyle="{StaticResource {x:Type DataGridColumnHeader}}"
                          AutoGenerateColumns="False"
                          SelectionMode="Single"
                          IsReadOnly="False"
                          Background="Transparent"
                          GridLinesVisibility="All"
                          RowBackground="Transparent"
                          AlternatingRowBackground="Transparent"
                          HorizontalGridLinesBrush="#55000000"
                          VerticalGridLinesBrush="#55000000"
                          HeadersVisibility="All"
                          BorderThickness="0">
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Обновить" Click="RefreshClick" InputGestureText="F5">
                                            <MenuItem.Icon>
                                                <Path Data="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <Separator/>
                                        <MenuItem Header="Статистика" Click="StatisticsButton_Click">
                                            <MenuItem.Icon>
                                                <Path Data="M9,17H7V10H9V17M13,17H11V7H13V17M17,17H15V13H17V17M19,19H5V5H19V19.1M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Отчётность" Click="ReportsButton_Click">
                                            <MenuItem.Icon>
                                                <Path Data="M19,21H5C3.9,21 3,20.1 3,19V5C3,3.9 3.9,3 5,3H9V5H5V19H19V15H21V19C21,20.1 20.1,21 19,21M17,9V7H12V12H14V10.4L18.6,15L20,13.6L15.4,9H17Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Графики" Click="ChartsButton_Click">
                                            <MenuItem.Icon>
                                                <Path Data="M3,22V8H7V22H3M10,22V2H14V22H10M17,22V14H21V22H17Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                            </DataGrid>
                        </Border>
                    </Grid>
                </Viewbox>
            </TabItem>
            <!-- Вкладка платежей -->
            <TabItem Header="Платежи">
                <Viewbox Stretch="Uniform">
                    <Grid Width="1355" Height="560">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="25*"/>
                            <ColumnDefinition Width="674*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Фоновое изображение -->
                        <Grid.Background>
                            <VisualBrush Stretch="UniformToFill">
                                <VisualBrush.Visual>
                                    <Image Source="/Images/6.png" 
                               Opacity="0.40" 
                               Stretch="UniformToFill"
                               RenderOptions.BitmapScalingMode="HighQuality"/>
                                </VisualBrush.Visual>
                            </VisualBrush>
                        </Grid.Background>

                        <!-- Подложка для таблицы -->
                        <Border Background="#FFE0F7FA" 
                    CornerRadius="5" 
                    Margin="10,10,10,431" 
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Stretch" 
                    VerticalAlignment="Stretch">
                            <DataGrid x:Name="DataGridPayments" 
                          CanUserAddRows="True"            
                          ContextMenuOpening="DataGridPayments_ContextMenuOpening"            
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          ColumnHeaderStyle="{StaticResource {x:Type DataGridColumnHeader}}"
                          AutoGenerateColumns="False"
                          SelectionMode="Single"
                          IsReadOnly="False"
                          Background="Transparent"
                          GridLinesVisibility="All"
                          RowBackground="Transparent"
                          AlternatingRowBackground="Transparent"
                          HorizontalGridLinesBrush="#55000000"
                          VerticalGridLinesBrush="#55000000"
                          HeadersVisibility="All"
                          BorderThickness="0">
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Обновить" Click="RefreshClick" InputGestureText="F5">
                                            <MenuItem.Icon>
                                                <Path Data="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <Separator/>
                                        <MenuItem  Header="Статистика" Click="StatisticsButton_Click">
                                            <MenuItem.Icon>
                                                <Path Data="M9,17H7V10H9V17M13,17H11V7H13V17M17,17H15V13H17V17M19,19H5V5H19V19.1M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Отчётность" Click="ReportsButton_Click">
                                            <MenuItem.Icon>
                                                <Path Data="M19,21H5C3.9,21 3,20.1 3,19V5C3,3.9 3.9,3 5,3H9V5H5V19H19V15H21V19C21,20.1 20.1,21 19,21M17,9V7H12V12H14V10.4L18.6,15L20,13.6L15.4,9H17Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Графики" Click="ChartsPayment_Click">
                                            <MenuItem.Icon>
                                                <Path Data="M3,22V8H7V22H3M10,22V2H14V22H10M17,22V14H21V22H17Z"
                                          Fill="{StaticResource MenuIconBrush}"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                            </DataGrid>
                        </Border>
                    </Grid>
                </Viewbox>
            </TabItem>
        </TabControl>
        <!-- Панель кнопок -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="10,10,10,10">
            <Button Content="Обновить" 
            Style="{StaticResource ModernButtonStyle}"
            Click="RefreshClick"
            Margin="5,0"/>

            <!-- Кнопки для обычных вкладок -->
            <StackPanel x:Name="StandardButtonsPanel" Orientation="Horizontal" >
                <Button Content="Добавить" 
                Style="{StaticResource ModernButtonStyle}"
                Click="AddClick"
                Margin="5,0"/>
                <Button Content="Редактировать" 
                Style="{StaticResource ModernButtonStyle}"
                Click="EditClick"
                Margin="5,0"/>
                <Button Content="Удалить" 
                Style="{StaticResource ModernButtonStyle}"
                Click="DeleteClick"
                Margin="5,0"/>
            </StackPanel>

            <!-- Кнопки для вкладок с аналитикой и отчётами -->
            <StackPanel x:Name="AnalyticsButtonsPanel" Orientation="Horizontal" Visibility="Collapsed">
                <Button Content="Добавить" 
                Style="{StaticResource ModernButtonStyle}"
                Click="AddClick"
                Margin="5,0"/>
                <Button Content="Редактировать" 
                Style="{StaticResource ModernButtonStyle}"
                Click="EditClick"
                Margin="5,0"/>
                <Button Content="Удалить" 
                Style="{StaticResource ModernButtonStyle}"
                Click="DeleteClick"
                Margin="5,0"/>
                <Button Content="Статистика" 
                Style="{StaticResource ModernButtonStyle}"
                Click="StatisticsButton_Click"
                Margin="5,0"/>
                <Button Content="Отчётность" 
                Style="{StaticResource ModernButtonStyle}"
                Click="ReportsButton_Click"
                Margin="5,0"/>
                <Button Content="Графики" 
                Style="{StaticResource ModernButtonStyle}"
                Click="ChartsButton_Click"
                Margin="5,0"/>
            </StackPanel>
        </StackPanel>

        <!-- Строка состояния -->
        <StatusBar Grid.Row="2" HorizontalAlignment="Left" VerticalAlignment="Bottom">
            <StatusBarItem>
                <TextBlock x:Name="StatusText" Text="Готово"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>

